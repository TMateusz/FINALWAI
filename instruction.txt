Zadanie | Punkty

Kategoria I
A) Przesyłanie plików na serwer | 2 (wymagane) Aby dostarczyć zdjęcia do galerii, należy zaimplementować funkcję przesyłania plików na serwer (ang. upload). Dozwolone powinny być wyłącznie pliki w formacie PNG lub JPG. Przesyłane pliki nie mogą przekraczać rozmiaru 1 MB. Jeśli użytkownik spróbuje wysłać zdjęcie o większym rozmiarze lub w innym formacie, powinien otrzymać stosowny komunikat (osobno dla formatu pliku, jego wielkości lub oba komunikaty jednocześnie). W katalogu, skonfigurowanym jako DocumentRoot aplikacji, należy dodać podkatalog images i umieszczać w nim przesłane na serwer zdjęcia [zwróć uwagę na uprawnienia do tego katalogu]. Dzięki temu serwer WWW będzie mógł później zaserwować zdjęcia przeglądarce, w celu ich wyświetlenia na stronie.

B) ~~Znak wodny i~~ Miniatura | 2 Po przesłaniu zdjęcia, po stronie serwera należy wygenerować miniaturkę o rozmiarze 200x125 pikseli. Wykorzystać należy bibliotekę PHP GD, która została zainstalowana w maszynie wirtualnej, w czasie konfiguracji środowiska pracy.

Po zaimplementowaniu powyższych operacji, na serwerze powinny znajdować się 2 pliki graficzne dla każdego przesłanego zdjęcia: oryginalne zdjęcie oraz miniaturka.

C) Galeria przesłanych zdjęć | 3 (wymagane) Należy przygotować kod PHP, pozwalający na wyświetlenie zbiorczej galerii wszystkich zdjęć, wysłanych na serwer. Galeria powinna prezentować miniaturki zdjęć (wygenerowane w ramach zadania I.B powyżej) na zasadzie stronicowania (paging) po xx sztuk na raz [wartość xx według preferencji twórcy]. Jeśli zadanie I.B nie zostało wykonane, należy wykorzystać oryginalne zdjęcia, ale zaprezentowane w pomniejszeniu przy użyciu stylów CSS. ~~Kliknięcie na miniaturę zdjęcia powinno kierować do zdjęcia ze znakiem wodnym w pełnym rozmiarze (jeśli zadanie I.B nie zostało zaimplementowane, należy wyświetlić oryginalne zdjęcie w pełnym rozmiarze).~~ W ramach zadania należy wykorzystać przynajmniej dwie spośród następujących dyrektyw języka PHP: include, include_once, require, require_once. Zastosowania muszą być zgodne z przeznaczeniem wybranych dyrektyw.

Kategoria II
A) Wykorzystanie bazy danych | 3 Formularz wysyłania plików należy uzupełnić o pola tekstowe „tytuł” oraz „autor”. Po otrzymaniu poprawnego pliku (format i rozmiar), dane o zdjęciu należy zapisać w bazie MongoDB. Informacje o tytułach i autorach poszczególnych zdjęć należy wyświetlać w galerii miniatur.

B) Rejestracja i logowanie użytkowników | 6 Należy przygotować formularz rejestracji użytkowników, zawierający pola: „adres e-mail”, „login”, „hasło”, „powtórz hasło”, „zdjęcie profilowe” (wszystkie pola obowiązkowe). Po zweryfikowaniu danych, otrzymanych z formularza (m.in. należy sprawdzić, czy wpisany login nie został już zajęty), należy zapisać nowego użytkownika (wszystkie pola z formularza) w bazie danych MongoDB. Należy pamiętać o przekształceniu hasła do postaci skrótu, przy użyciu bezpiecznej funkcji hashującej. Dla przesłanego zdjęcia profilowego wykonać miniaturkę (rozmiar dobrać do planowanej wielkości wyświetlania). Zapisać tylko miniaturkę (pod unikalną nazwą) do katalogu ProfilesFoto. Wykorzystać powtórnie funkcje cześć kodu z kategorii IA i IB. Jeżeli IB nie wykonano, to przesyłać odpowiednio małe zdjęcie użytkownika. Należy przygotować formularz logowania, zawierający pola „login” i „hasło”. Do uwierzytelniania należy wykorzystać bazę zarejestrowanych użytkowników aplikacji. Jeśli podany login i hasło pasują do jednego z istniejących w bazie danych użytkowników, należy zapisać w sesji jego identyfikator i wyświetlić komunikat o pomyślnym logowaniu. W przeciwnym razie należy ponownie wyświetlić formularz logowania wraz z komunikatem o niepowodzeniu. Dla użytkownika zalogowanego formularz logowania nie powinien być widoczny. Dla użytkownika zalogowanego widoczny login użytkownika i jego zdjęcie profilowe, dostępna możliwość wylogowania;

C) Mechanizm sesji | 6 Należy zmodyfikować galerię miniatur tak, aby przy każdym zdjęciu widoczne było pole typu checkbox, identyfikujące dane zdjęcie (można wykorzystać wartości pola _id z bazy danych). Należy również dodać przycisk „Zapamiętaj wybrane”. Gdy użytkownik zaznaczy zdjęcia i kliknie przycisk, należy zapamiętać jego wybór w sesji. Gdy użytkownik po raz kolejny wejdzie na stronę galerii miniatur, zapamiętane wcześniej zdjęcia powinny mieć zaznaczone przypisane im pola typu checkbox. Należy dodać kolejną osobną podstronę w aplikacji, prezentującą wyłącznie zdjęcia, które zostały wcześniej zapamiętane przez użytkownika. Przy wszystkich zdjęciach na tej podstronie ponownie należy wyświetlić pola typu checkbox, które pozwolą na usunięcie zaznaczonych zdjęć ze zbioru zapamiętanych w sesji (po kliknięciu przycisku „Usuń zaznaczone z zapamiętanych”). Dodatkowo należy dla każdego zapamiętanego zdjęcia dodać pole określenia ilości (np. odbitek do zamówienia) również zapamiętywane razem z id zdjęcia i wyświetlane w każdym podglądzie zapamiętanych zdjęć. W galerii miniatur wyświetlać aktualizowaną ikonę kosza z łączną liczbą zapamiętanych elementów (1 zdjęcie 2 sztuki, drugie 1 sztuka => łącznie 3 elementy zapamiętane). Wykorzystać mechanizm partial View dla tego elementu. Funkcjonalność jest analogiczna do dodawania/usuwania produktów do/z koszyka zakupowego.

Kategoria III
A) Rozróżnianie użytkowników | 5 Formularz przesyłania zdjęć należy zmodyfikować tak, aby oferował dodatkowe funkcje zalogowanym użytkownikom. Gdy użytkownik jest zalogowany, pole „autor” formularza powinno automatycznie zawierać login użytkownika. Ponadto dla zalogowanych użytkowników należy wyświetlać dodatkowe pole typu radio, pozwalające na przełączanie pomiędzy wartościami „publiczne” oraz „prywatne”. Jeśli użytkownik wybierze opcję „prywatne”, zdjęcie nie powinno być widoczne w galerii miniatur dla innych użytkowników (zarówno zalogowanych jak i anonimowych). Zdjęcie powinno być widoczne w galerii dla użytkownika, który je przesłał (wraz z informacją, że jest ono prywatne). Zdjęcia publiczne należy obsługiwać tak, jak dotychczas. Zdjęcia przesyłane przez niezalogowanych użytkowników należy automatycznie traktować jako publiczne.

B) AJAX – wyszukiwarka zdjęć | 4 Na osobnej podstronie w aplikacji należy zaimplementować wyszukiwarkę zdjęć, wykorzystującą technologię AJAX. Po wejściu na tę podstronę, widoczne powinno być pole tekstowe, do którego użytkownik może wpisać fragment tytułu zdjęcia, którego poszukuje. W miarę wpisywania w wyszukiwarkę kolejnych liter przez użytkownika (np. w reakcji na zdarzenie onkeyup) należy wysyłać do serwera kolejne asynchroniczne żądania HTTP (AJAX), które zawierają aktualną wartość pola tekstowego. Serwer wyszukuje zdjęcia, których tytuły zawierają frazę wpisaną przez użytkownika i w odpowiedzi wysyła fragment kodu HTML, prezentujący miniatury dopasowanych zdjęć. Przeglądarka, po otrzymaniu odpowiedzi z serwera, wyświetla dopasowane miniatury użytkownikowi.